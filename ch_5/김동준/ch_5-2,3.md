5-2 생각해보기

모킹 처리와 의존성 주입의 관계

*교재 예제가 아닌 내 코드 바탕으로 생각해보기*

https://tech.kakaopay.com/post/implementing-tdd-in-practical-applications/

# 테스트 코드

## 1. 단위 테스트

### 1) 단위 테스트 vs 통합 테스트

#### 단위 테스트
- 코드 수준의 테스트
- 클래스, 함수의 예상 동작 범위 테스트
#### 통합 테스트 
- 요청을 시작하여 코드가 실행 결과를 반환하는 전체 경로에 대한 테스트
- 전체 시스템, 기능 단위의 모듈 대상 테스트
- `@SpringBootTest` 가 붙은 클래스 내부에 있는 모든 테스트 메소드들이 순차적으로 잘 동작하는지 확인
- 모킹 없이 외부 실제 데이터베이스 혹은 서비스 API와의 연동 테스트까지 범위에 포함

### 2) 테스트 프레임워크를 써야 되는 이유?
- 일단 분기 처리나 로그 이런 부수적인 관심사들 자동 처리
- 무엇보다 트랜잭션 관리가 매우 불편함

## 2. 교재가 말하고자 하는 바

### 1) 기능의 동작 점검 뿐만이 아닌, 테스트 코드 작성의 난도 자체가 코드 설계가 옳게 이뤄지는지 기준
- 그래서 작성 자체가 곧 리팩토링 과정
### 2) 결국 테스트 코드를 작성하기 쉬운 코드를 작성해야 함
- 의존성 주입
- 기능 논리 자체를 캡슐화
- 클래스 재정의

## 3. 단위 테스트에 대한 고민

### 1) 단위 테스트와 의존성 주입
- 보통 WAS를 설계할 때, 의존성 주입을 통해 모듈(클래스) 간의 결합도를 낮추면서 주입된 모듈의 기능을 갖고와 동작하는 경우가 많다.
- 테스트 단위와 모킹 범위의 불일치 이슈

### 2) 프레임워크와 라이브러리의 책임 증가
- 내가 생각한 기능을 이미 다른 의존성이 주도권을 가진 경우
- 단위 테스트 범위 지정 이슈
