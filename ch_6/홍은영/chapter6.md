> 생성 패턴  
> 객체 생성 문제를 해결하고 복잡한 생성 프로세스를 캡슐화하며 객체의 생성 코드와 사용 코드 분리하는 패턴
<br>

# 싱글턴 패턴
- 클래스의 객체나 인스턴스를 하나만 생성
- new 키워드 없이 바로 사용할 수 있어서 편리
- ex) 시스템 설정 정보 관리, 고유 ID 생성
- 가급적 사용 X  
  → but, 클래스 확장가능성이 없고 외부 시스템에 의존하지 않으면 싱글턴이 합리적

## 구현
**싱글턴 구현 조건**
1. 생성자를 private로 선언해 외부에서 new를 이용한 인스턴스 생성 방지
2. 객체 생성될 때 스레드 안전성 보장 확인
3. 지연 로딩 지원여부 확인
4. getInstance() 성능 검토
<br>

### 1. 즉시 초기화
- 클래스가 메모리에 적재될 때 인스턴스 생성
- 지연 적재 미지원
- 사용하지 않아도 인스턴스를 만들어 메모리 낭비 발생

### 2. 늦은 초기화
- getInstance() 호출할 때 인스턴스 생성
- 지연 적재 지원
- 초기화 시간이 오래 걸리면 시스템 성능에 영향  
  → 즉시 초기화 방식으로 해결 가능
- 동시성이 낮아 병목 현상 발생 가능


> PermGen Space OOM(Out Of Memory)
> - Tomcat에서 가용할 수 있는 최대 메모리보다 어플리케이션을 구동하는데 필요한 메모리가 더 커서 발생하는 문제
> - JDK 8 이상부턴 PermGen 영역 정보를 Metaspace로 이동하면서 PermGen 제거함
> - 디폴트 값이 작아서 PermGen Space OOM 에러 발생하면 maxpermsize 값 증가
> 상세 내용은 https://buly.kr/1uH2KR 참고
<br>

### 3. 이중 잠금
- 지연 적재와 높은 동시성을 모두 지원
- 인스턴스 생성 후 getInstance()를 계속 호출해도 잠금 미발생 → 낮은 동시성 해결

### 4. 홀더에 의한 초기화
- 정적 내부 클래스를 사용하는 방식
- 스레드 안정성 보장, 지연 로딩 가능

### 5. 열거
- 열거형 특성을 활용해서 스레드 안전성과 인스턴스 유일성 보장
<br>

## 단점
1. 클래스 간의 의존성 감춤
2. 확장성이 낮고 테스트 어려움
4. 매개변수가 있는 생성자 지원 X → 매개변수를 통해 크기 지정 불가
  **해결방법**
    1) init()로 매개변수 전달
    2) 매개변수를 getInstance()에 전달
      - 첫번째 이후 getInstance는 효과 없음
    3) 매개변수를 전역 변수에 넣기
<br>

## 대안
- 정적 메서드 사용  
  → 테스트 용이성과 확장성 문제 해결 불가
- 의존성 주입
  - 싱글턴으로 생성된 객체를 매개변수로 함수에 전달
  - 생성자를 통해 클래스의 멤버 변수에 전달  
  → 마찬가지로 테스트 용이성과 확장성 문제 해결 불가
<br>

## 다중 인스턴스 패턴
- 클래스가 여러 객체를 생성할 수 있지만 갯수 제한
- 동일한 유형 객체는 하나만 생성 가능, 다른 유형은 여러 개 생성 가능
- 팩토리 패턴과 유사
<br><br><br>
